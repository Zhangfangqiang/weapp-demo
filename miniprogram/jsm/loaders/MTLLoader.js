export default function(a){let{Color:l,DefaultLoadingManager:p,FileLoader:o,FrontSide:t,Loader:r,LoaderUtils:c,MeshPhongMaterial:f,RepeatWrapping:e,TextureLoader:h,Vector2:i}=a;var u=function(a){r.call(this,a)};u.prototype=Object.assign(Object.create(r.prototype),{constructor:u,load:function(a,r,t,e){var s=this;var i=this.path===""?c.extractUrlBase(a):this.path;var n=new o(this.manager);n.setPath(this.path);n.load(a,function(a){r(s.parse(a,i))},t,e)},setMaterialOptions:function(a){this.materialOptions=a;return this},parse:function(a,r){var t=a.split("\n");var e={};var s=/\s+/;var i={};for(var n=0;n<t.length;n++){var o=t[n];o=o.trim();if(o.length===0||o.charAt(0)==="#"){continue}var p=o.indexOf(" ");var l=p>=0?o.substring(0,p):o;l=l.toLowerCase();var c=p>=0?o.substring(p+1):"";c=c.trim();if(l==="newmtl"){e={name:c};i[c]=e}else{if(l==="ka"||l==="kd"||l==="ks"||l==="ke"){var f=c.split(s,3);e[l]=[parseFloat(f[0]),parseFloat(f[1]),parseFloat(f[2])]}else{e[l]=c}}}var h=new u.MaterialCreator(this.resourcePath||r,this.materialOptions);h.setCrossOrigin(this.crossOrigin);h.setManager(this.manager);h.setMaterials(i);return h}});u.MaterialCreator=function(a,r){this.baseUrl=a||"";this.options=r;this.materialsInfo={};this.materials={};this.materialsArray=[];this.nameLookup={};this.side=this.options&&this.options.side?this.options.side:t;this.wrap=this.options&&this.options.wrap?this.options.wrap:e};u.MaterialCreator.prototype={constructor:u.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(a){this.crossOrigin=a;return this},setManager:function(a){this.manager=a},setMaterials:function(a){this.materialsInfo=this.convert(a);this.materials={};this.materialsArray=[];this.nameLookup={}},convert:function(a){if(!this.options)return a;var r={};for(var t in a){var e=a[t];var s={};r[t]=s;for(var i in e){var n=true;var o=e[i];var p=i.toLowerCase();switch(p){case"kd":case"ka":case"ks":if(this.options&&this.options.normalizeRGB){o=[o[0]/255,o[1]/255,o[2]/255]}if(this.options&&this.options.ignoreZeroRGBs){if(o[0]===0&&o[1]===0&&o[2]===0){n=false}}break;default:break}if(n){s[p]=o}}}return r},preload:function(){for(var a in this.materialsInfo){this.create(a)}},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0;for(var r in this.materialsInfo){this.materialsArray[a]=this.create(r);this.nameLookup[r]=a;a++}return this.materialsArray},create:function(a){if(this.materials[a]===undefined){this.createMaterial_(a)}return this.materials[a]},createMaterial_:function(a){var s=this;var r=this.materialsInfo[a];var i={name:a,side:this.side};function n(a,r){if(typeof r!=="string"||r==="")return"";if(/^https?:\/\//i.test(r))return r;return a+r}function t(a,r){if(i[a])return;var t=s.getTextureParams(r,i);var e=s.loadTexture(n(s.baseUrl,t.url));e.repeat.copy(t.scale);e.offset.copy(t.offset);e.wrapS=s.wrap;e.wrapT=s.wrap;i[a]=e}for(var e in r){var o=r[e];var p;if(o==="")continue;switch(e.toLowerCase()){case"kd":i.color=(new l).fromArray(o);break;case"ks":i.specular=(new l).fromArray(o);break;case"ke":i.emissive=(new l).fromArray(o);break;case"map_kd":t("map",o);break;case"map_ks":t("specularMap",o);break;case"map_ke":t("emissiveMap",o);break;case"norm":t("normalMap",o);break;case"map_bump":case"bump":t("bumpMap",o);break;case"map_d":t("alphaMap",o);i.transparent=true;break;case"ns":i.shininess=parseFloat(o);break;case"d":p=parseFloat(o);if(p<1){i.opacity=p;i.transparent=true}break;case"tr":p=parseFloat(o);if(this.options&&this.options.invertTrProperty)p=1-p;if(p>0){i.opacity=1-p;i.transparent=true}break;default:break}}this.materials[a]=new f(i);return this.materials[a]},getTextureParams:function(a,r){var t={scale:new i(1,1),offset:new i(0,0)};var e=a.split(/\s+/);var s;s=e.indexOf("-bm");if(s>=0){r.bumpScale=parseFloat(e[s+1]);e.splice(s,2)}s=e.indexOf("-s");if(s>=0){t.scale.set(parseFloat(e[s+1]),parseFloat(e[s+2]));e.splice(s,4)}s=e.indexOf("-o");if(s>=0){t.offset.set(parseFloat(e[s+1]),parseFloat(e[s+2]));e.splice(s,4)}t.url=e.join(" ").trim();return t},loadTexture:function(a,r,t,e,s){var i;var n=this.manager!==undefined?this.manager:p;var o=n.getHandler(a);if(o===null){o=new h(n)}if(o.setCrossOrigin)o.setCrossOrigin(this.crossOrigin);i=o.load(a,t,e,s);if(r!==undefined)i.mapping=r;return i}};return{MTLLoader:u}}